"0","sim_IGMRF_fun <- function(Q, epsilon, seed) {"
"0","  set.seed(seed)"
"0","  Q_tilde <- Q + epsilon * diag(1, nrow(Q), ncol(Q))"
"0","  L_tilde <- t(chol(Q_tilde))"
"0","  z <- rnorm(nrow(Q))"
"0","  v <- solve(t(L_tilde), z)"
"0","  x <- v - mean(v)"
"0","  return(as.vector(x))"
"0","}"
"0",""
"0","sim_GMRF_fun <- function(mu, Q, seed) {"
"0","  set.seed(seed)"
"0","  L <- t(chol(Q))"
"0","  z <- rnorm(nrow(Q))"
"0","  v <- solve(t(L), z)"
"0","  x <- mu + v"
"0","  return(x)"
"0","}"
"0",""
"0","sim_fun_plot <- function(map, x, limits = NULL, lab = ""Value"") {"
"0","  "
"0","  if (is.null(limits)) limits <- range(x)"
"0","  "
"0","  map$x <- x"
"0","  return(ggplot() +"
"0","           geom_sf(aes(fill = x),"
"0","                   data = map,"
"0","                   color = ""gray"") +"
"0","           scale_fill_viridis_c(direction = -1, limits = limits) +"
"0","           guides(fill = guide_colorbar(lab, label = T, ticks = F, barwidth = 1, barheight = 20)) +"
"0","           theme("
"0","             axis.text = element_text(size = 15, margin = unit(0.5, ""cm"")),"
"0","             axis.title = element_blank(),"
"0","             legend.title = element_text(size = 15),"
"0","             legend.text = element_text(size = 14),"
"0","             # legend.position = ""none"","
"0","             axis.line = element_line(colour = ""black""),"
"0","             axis.ticks = element_line(linewidth = 1),"
"0","             axis.ticks.length = unit(0.3, ""cm""),"
"0","             axis.text.x = element_text(angle = 90, hjust = 1, vjust = .5),"
"0","             # panel.background = element_blank(),"
"0","             # panel.grid.major = element_blank(),"
"0","             # panel.grid.minor = element_blank(),"
"0","           ))"
"0","}"
"0",""
"0","admin1_tau_1_sim_seed_1 <- sim_IGMRF_fun(precision_matrix(Admin1Graph, 1), 1e-6, 1)"
"0","admin1_tau_1_sim_seed_2 <- sim_IGMRF_fun(precision_matrix(Admin1Graph, 1), 1e-6, 2)"
"0","mv_gaussian_dim_37_mean_0_cov_1_seed_1 <- sim_GMRF_fun(0, solve(diag(1, 37, 37)), 1)"
"0","mv_gaussian_dim_37_mean_0_cov_1_seed_2 <- sim_GMRF_fun(0, solve(diag(1, 37, 37)), 2)"
"0",""
"0","plot_b_range <- range(admin1_tau_1_sim_seed_1, admin1_tau_1_sim_seed_2, mv_gaussian_dim_37_mean_0_cov_1_seed_1, mv_gaussian_dim_37_mean_0_cov_1_seed_2)"
"0",""
"0","admin1_tau_1_sim_seed_1_plot <- sim_fun_plot(nigeriaAdm1, admin1_tau_1_sim_seed_1, plot_b_range)"
"0","admin1_tau_1_sim_seed_2_plot <- sim_fun_plot(nigeriaAdm1, admin1_tau_1_sim_seed_2, plot_b_range)"
"0",""
"0","mv_gaussian_dim_37_mean_0_cov_1_seed_1_plot <- sim_fun_plot(nigeriaAdm1, mv_gaussian_dim_37_mean_0_cov_1_seed_1, plot_b_range)"
"0","mv_gaussian_dim_37_mean_0_cov_1_seed_2_plot <- sim_fun_plot(nigeriaAdm1, mv_gaussian_dim_37_mean_0_cov_1_seed_2, plot_b_range)"
"0",""
"0","admin1_tau_1_sim_seed_1_plot"
