"0","cond_mu_vector_fun <- function(Q_1, M, Q_2, y) return(solve(Q_1 + t(M) %*% Q_2 %*% M) %*% t(M) %*% Q_2 %*% y)"
"0","cond_Precision_matrix_fun <- function(Q_1, M, Q_2) return(Q_1 + t(M) %*% Q_2 %*% M)"
"0",""
"0","sim_n_conditional_expit_GMRF_fun <- function(y, M, Q_1, Q_2, n) {"
"0","  df <- data.frame(matrix(nrow = n, ncol = nrow(Q_1)))"
"0","  colnames(df) <- colnames(Q_1)"
"0","  "
"0","  mu <- cond_mu_vector_fun(Q_1, M, Q_2, y)"
"0","  Q <- cond_Precision_matrix_fun(Q_1, M, Q_2)"
"0","  "
"0","  for (i in 1:n) df[i,] <- plogis(sim_GMRF_fun(mu, Q, i))"
"0","  "
"0","  return(df)"
"0","}"
"0",""
"0","sim_100_expit_GMRF_c <- sim_n_conditional_expit_GMRF_fun(DirectEstimates$Observation, diag(1, 37, 37), precision_matrix(Admin1Graph, 1), solve(V), 100)"
"0",""
"0","sim_100_expit_GMRF_c_median <- apply(sim_100_expit_GMRF_c, 2, median)"
"0","sim_100_expit_GMRF_c_coef_var <- apply(sim_100_expit_GMRF_c, 2, sd) / apply(sim_100_expit_GMRF_c, 2, mean)"
"0",""
"0","sim_100_expit_GMRF_c_median_plot <- sim_fun_plot(nigeriaAdm1, sim_100_expit_GMRF_c_median, c(0, 1), lab = ""Median"")"
"0","sim_100_expit_GMRF_c_coef_var_plot <- sim_fun_plot(nigeriaAdm1, sim_100_expit_GMRF_c_coef_var, c(0, .4), lab = ""Coef. \nVar."")"
"0",""
"0","sim_100_expit_GMRF_c_median_plot"
