"0","structure_matrix <- function(graph) return(diag(rowSums(graph), nrow = nrow(graph), ncol = ncol(graph)) - graph)"
"0",""
"0","precision_matrix <- function(graph, tau) return(tau * structure_matrix(graph))"
"0",""
"0","sparse_df <- function(matrix) {"
"0","  "
"0","  matrix[matrix != 0] <- ""non-zero"""
"0","  matrix[matrix == 0] <- ""zero"""
"0","  "
"0","  df <- data.frame(x = as.factor(rep(1:nrow(matrix), each = ncol(matrix))), ""x names"" = rep(rownames(matrix), each = ncol(matrix)), y = as.factor(rep(1:ncol(matrix), nrow(matrix))), ""y names"" = rep(rownames(matrix), each = ncol(matrix)), value = as.factor(as.vector(as.matrix(matrix))))"
"0","  "
"0","  return(df)"
"0","}"
"0",""
"0","names <- rownames(Admin1Graph)"
"0",""
"0","sparsity_plot <- function(matrix, names) {"
"0","  df <- sparse_df(matrix)"
"0","  df_names <- unique(df$x.names)"
"0","  "
"0","  namess <- numeric(length(df_names))"
"0","  for (i in as.numeric(unique(df$x))) {"
"0","    namess[i] <- gsub(""\\:.*"", """", (df_names[i]))"
"0","  }"
"0","  "
"0","  names_df <- data.frame(name = as.factor(names), min_position = as.vector(sapply(names, function(i) min(which(str_detect(namess, i))))), max_position = as.vector(sapply(names, function(i) max(which(str_detect(namess, i))))))"
"0","  "
"0","  names_df <- names_df %>% mutate(position = as.integer((min_position + max_position) / 2), left_line = min_position - .5, right_line = max_position + .5)"
"0","  "
"0","  return(ggplot(df) +"
"0","           geom_raster(aes(x = x, y = y, fill = value)) +"
"0","           # geom_vline(xintercept = unique(c(names_df$left_line, names_df$right_line)), linewidth = .5, color = ""gray"") +"
"0","           # geom_hline(yintercept = unique(c(names_df$left_line, names_df$right_line)), linewidth = .5, color = ""gray"") +"
"0","           coord_fixed() +"
"0","           scale_fill_manual(values = c(""non-zero"" = ""#7E0020"", ""zero"" = ""#FFFFC9"")) +"
"0","           scale_x_discrete(breaks = names_df$position, labels = names_df$name) +"
"0","           scale_y_discrete(breaks = names_df$position, labels = names_df$name, limits = rev) +"
"0","           theme("
"0","             axis.text = element_text(size = 8, margin = unit(0.5, ""cm"")),"
"0","             axis.title = element_blank(),"
"0","             legend.title = element_text(size = 15),"
"0","             legend.text = element_text(size = 14),"
"0","             legend.position = ""none"","
"0","             axis.line = element_line(colour = ""black""),"
"0","             axis.ticks = element_line(linewidth = 1),"
"0","             axis.ticks.length = unit(0.3, ""cm""),"
"0","             axis.text.x = element_text(angle = 90, hjust = 1, vjust = .5),"
"0","             panel.background = element_blank(),"
"0","             panel.grid.major = element_blank(),"
"0","             panel.grid.minor = element_blank(),"
"0","           ))"
"0","}"
"0",""
"0","Q_1_sparsity_plot <- sparsity_plot(precision_matrix(Admin1Graph, 1), names)"
"0","Q_2_sparsity_plot <- sparsity_plot(precision_matrix(Admin2Graph, 1), names)"
"0",""
"0","Q_1_sparsity_plot"
