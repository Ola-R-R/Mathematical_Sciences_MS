"0","h = seq(0, 1e2, 1e-2)"
"0",""
"0","# My cov.spatial function that uses the parametrizations from the slides"
"0","my.cov.spatial <- function(h, cov.model, cov.pars, kappa) {"
"0","  if (cov.model == ""matern"") return(cov.spatial(h, cov.model, c(cov.pars[1], cov.pars[2]/(sqrt(8 * kappa))), kappa))"
"0","  if (cov.model == ""exponential"") return(cov.spatial(h, cov.model, cov.pars))"
"0","  if (cov.model == ""powered.exponential"") return(cov.spatial(h, cov.model, cov.pars, kappa))"
"0","  return(cat(""Invalid covariance model. Please use 'matern', 'exponential' or 'powered.exponential'""))"
"0","}"
"0",""
"0","# Function that plots the correlation function given distance h"
"0","my.cov.spatial.corr.plot <- function(h, cov.model, cov.pars, kappa) {"
"0","  df <- data.frame(h = h, corr = my.cov.spatial(h, cov.model, cov.pars, kappa))"
"0","  "
"0","  return(ggplot(df) +"
"0","           geom_line(aes(x = h, y = corr), show.legend = F, linewidth = 1.5) +"
"0","           labs(x = ""Distance"", y = ""Correlation"") +"
"0","           theme(axis.text = element_text(size = 15, margin = unit(0.5, ""cm"")),"
"0","                 axis.title = element_text(size = 18),"
"0","                 plot.title = element_text(size = 20),"
"0","                 legend.title = element_text(size = 15),"
"0","                 legend.text = element_text(size = 14),"
"0","                 legend.position = ""none"","
"0","                 axis.line = element_line(colour = ""black""),"
"0","                 axis.ticks = element_line(linewidth = 1),"
"0","                 axis.ticks.length = unit(0.3, ""cm"")))"
"0","}"
"0",""
"0","# Function that plots the semi-variogram function given distance h"
"0","my.cov.spatial.semi.var.plot <- function(h, cov.model, cov.pars, kappa) {"
"0","  semi.var <- my.cov.spatial(0, cov.model, cov.pars, kappa) - my.cov.spatial(h, cov.model, cov.pars, kappa)"
"0","  df <- data.frame(h = h, semi.variance = semi.var)"
"0","  "
"0","  return(ggplot(df) +"
"0","           geom_line(aes(x = h, y = semi.variance), show.legend = F, linewidth = 1.5) +"
"0","           labs(x = ""Distance"", y = ""Semi-variance"") +"
"0","           scale_y_continuous(labels = comma_format(.01)) +"
"0","           theme(axis.text = element_text(size = 15, margin = unit(0.5, ""cm"")),"
"0","                 axis.title = element_text(size = 18),"
"0","                 plot.title = element_text(size = 20),"
"0","                 legend.title = element_text(size = 15),"
"0","                 legend.text = element_text(size = 14),"
"0","                 legend.position = ""none"","
"0","                 axis.line = element_line(colour = ""black""),"
"0","                 axis.ticks = element_line(linewidth = 1),"
"0","                 axis.ticks.length = unit(0.3, ""cm"")))"
"0","}"
"0",""
"0","p.e.power.1.scale.10.corr.plot <- my.cov.spatial.corr.plot(h, ""powered.exponential"", c(1, 10), 1)"
"0","p.e.power.1.9.scale.10.corr.plot <- my.cov.spatial.corr.plot(h, ""powered.exponential"", c(1, 10), 1.9)"
"0","m.smooth.1.range.20.corr.plot <- my.cov.spatial.corr.plot(h, ""matern"", c(1, 20), 1)"
"0","m.smooth.3.range.20.corr.plot <- my.cov.spatial.corr.plot(h, ""matern"", c(1, 20), 3)"
"0",""
"0","p.e.power.1.scale.10.corr.plot"
