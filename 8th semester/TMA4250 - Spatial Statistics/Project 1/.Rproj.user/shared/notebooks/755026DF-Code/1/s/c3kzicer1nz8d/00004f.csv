"0","# Defining the regular grid"
"0","D <- 1:50"
"0",""
"0","# Function that calculates the covariance matrix of X"
"0","my.cov.X <- function(D, cov.model, cov.pars, kappa) return(my.cov.spatial(as.matrix(dist(as.matrix(D))), cov.model, cov.pars, kappa))"
"0",""
"0","# Function that creates n realizations of X"
"0","my.sim.X <- function(D, cov.model, cov.pars, kappa, n, seed = cov.pars[1]) {"
"0","  D <- as.matrix(D)"
"0","  df <- data.frame(D = rep(D,n), Value = NA, Realization = as.factor(rep(1:n, each = nrow(D))))"
"0","  mu <- rep(0, nrow(D))"
"0","  Sigma <- my.cov.X(D, cov.model, cov.pars, kappa)"
"0","  "
"0","  set.seed(seed)"
"0","  for (i in 1:n) df[df$Realization == i, ""Value""] <- mvrnorm(1, mu, Sigma)"
"0","  "
"0","  return(df)"
"0","}"
"0",""
"0","# Function that plots the n realizations of X"
"0","my.sim.X.plot <- function(D, cov.model, cov.pars, kappa, n) {"
"0","  df <- my.sim.X(D, cov.model, cov.pars, kappa, n)"
"0","  return(ggplot(df) +"
"0","           geom_line(aes(x = D, y = Value, color = Realization)) +"
"0","           labs(x = ""Location"", y = ""Value"", color = ""Realization"") +"
"0","           ylim(-8, 8) +"
"0","           theme(axis.text = element_text(size = 15, margin = unit(0.5, ""cm"")),"
"0","                 axis.title = element_text(size = 18),"
"0","                 plot.title = element_text(size = 20),"
"0","                 legend.title = element_text(size = 15),"
"0","                 legend.text = element_text(size = 14),"
"0","                 legend.position = ""none"","
"0","                 axis.line = element_line(colour = ""black""),"
"0","                 axis.ticks = element_line(linewidth = 1),"
"0","                 axis.ticks.length = unit(0.3, ""cm"")))"
"0","}"
"0",""
"0","p.e.power.1.scale.10.marginal.1.realizations.4.plot <- my.sim.X.plot(D, ""powered.exponential"", c(1, 10), 1, 4)"
"0","p.e.power.1.scale.10.marginal.5.realizations.4.plot <- my.sim.X.plot(D, ""powered.exponential"", c(5, 10), 1, 4)"
"0","p.e.power.1.9.scale.10.marginal.1.realizations.4.plot <- my.sim.X.plot(D, ""powered.exponential"", c(1, 10), 1.9, 4)"
"0","p.e.power.1.9.scale.10.marginal.5.realizations.4.plot <- my.sim.X.plot(D, ""powered.exponential"", c(5, 10), 1.9, 4)"
"0","m.smooth.1.range.20.marginal.1.realizations.4.plot <- my.sim.X.plot(D, ""matern"", c(1, 20), 1, 4)"
"0","m.smooth.1.range.20.marginal.5.realizations.4.plot <- my.sim.X.plot(D, ""matern"", c(5, 20), 1, 4)"
"0","m.smooth.3.range.20.marginal.1.realizations.4.plot <- my.sim.X.plot(D, ""matern"", c(1, 20), 3, 4)"
"0","m.smooth.3.range.20.marginal.5.realizations.4.plot <- my.sim.X.plot(D, ""matern"", c(5, 20), 3, 4)"
"0",""
"0","p.e.power.1.scale.10.marginal.1.realizations.4.plot"
